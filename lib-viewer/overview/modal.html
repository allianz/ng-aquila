<p class="docs-markdown--p">The <code>NxDialogService</code> can be used to open modals from components or predefined templates.</p>
<p class="docs-markdown--p">The class <code>nx-modal-margin-bottom</code> can be used to get the correct vertical spacing for the elements withing the modal.</p>
<p class="docs-markdown--p"><strong>Important:</strong> Please note that the module for this component depends on the Angular animations module, so in case you do not already have it, you need to explicitly import the <code>BrowserModule</code> and <code>BrowserAnimationsModule</code> in your app.module.</p>
<p class="docs-markdown--p">The visual representation of modal overlay depends on Angular CDK styles. Make sure you <a href="./documentation/overlay/overview#angular-cdk">enable Angular CDK styles</a> in your application.</p>
<h3 id="modal-opening" tabindex="-1" class="docs-markdown--h3">Modal Opening</h3>
<p class="docs-markdown--p">A modal can be opened by using the <code>open</code> method of the service and passing an optional configuration object as a second parameter as shown below. The return object of the open function is a reference to the opened modal, which can be used for closing the modal or subscribing to its closing events.</p>
<pre><code class="language-ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">myDialogData</span>: <span class="hljs-title class_">MyDialogData</span> = { <span class="hljs-comment">/* some data */</span> };

<span class="hljs-keyword">const</span> <span class="hljs-attr">myDialogRef</span>: <span class="hljs-title class_">NxModalRef</span>&lt;<span class="hljs-title class_">MyDialogComponent</span>, <span class="hljs-title class_">MyDialogResult</span>&gt; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogService</span>.<span class="hljs-title function_">open</span>(<span class="hljs-title class_">MyDialogComponent</span>, {
    <span class="hljs-attr">width</span>: <span class="hljs-string">&#x27;600px&#x27;</span>,
    <span class="hljs-attr">data</span>: myDialogData,
});

<span class="hljs-comment">// always support undefined result type for easily closable dialogs</span>
myDialogRef.<span class="hljs-title function_">beforeClosed</span>().<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Dialog result: <span class="hljs-subst">${result}</span>`</span>);
});

<span class="hljs-comment">// result parameter is optional, defaults to undefined</span>
myDialogRef.<span class="hljs-title function_">close</span>(<span class="hljs-string">&#x27;some dialog result&#x27;</span>);
</code></pre>
<p class="docs-markdown--p">The example below shows how the modal dialog can be opened <strong>with a template</strong> and <strong>with a component</strong>.</p>
<div nx-docs-example="modal-opening" config="{}">exampleID: modal-opening</div>
<h3 id="modal-closing" tabindex="-1" class="docs-markdown--h3">Modal Closing</h3>
<p class="docs-markdown--p">You can close a dialog in three different ways:</p>
<ul class="docs-markdown--ul">
<li class="docs-markdown--li">set <code>NxModalConfig.closeIconButton</code> to <code>true</code> to show a standard close button, returning <code>undefined</code> as result.</li>
<li class="docs-markdown--li">call <code>NxModalRef.close()</code> programatically, optionally with a result parameter. Returns <code>undefined</code> by default.</li>
<li class="docs-markdown--li">use <code>nxModalClose</code> directive on an action button, optionally with a result input. Returns <code>undefined</code> by default.</li>
</ul>
<p class="docs-markdown--p">The dialog result can be observed by subscribing to <code>NxModalRef.beforeClosed()</code> and <code>NxModalRef.afterClosed()</code> observables.</p>
<p class="docs-markdown--p">The three different closing variants are demonstrated in the example below:</p>
<div nx-docs-example="modal-closing" config="{}">exampleID: modal-closing</div>
<h3 id="closing-behaviour" tabindex="-1" class="docs-markdown--h3">Closing behaviour</h3>
<p class="docs-markdown--p">By default, the modal will close if the user clicks on the backdrop or hits the ESC key. These options can be disabled by using the <code>disableClose</code> parameter of the <code>NxModalConfig</code> as shown in the example below:</p>
<div nx-docs-example="modal-closing-behaviour" config="{}">exampleID: modal-closing-behaviour</div>
<h3 id="modal-content-directives" tabindex="-1" class="docs-markdown--h3">Modal Content Directives</h3>
<p class="docs-markdown--p">You can separate the dialog body into dialog content and dialog actions by using the directives <code>nxModalContent</code> and <code>nxModalActions</code>. <code>nxModalActions</code> is container for action buttons placed at the bottom of the dialog. <code>nxModalTitle</code> can be used to put the title above or inside the <code>nxModalContent</code>. Placed inside <code>nxModalContent</code> the headline will scroll with the content, placed on top it will stay fixed. The example below shows how to apply them for a Dialog with a disclaimer look.</p>
<div nx-docs-example="modal-content-actions" config="{}">exampleID: modal-content-actions</div>
<h3 id="fixed-width" tabindex="-1" class="docs-markdown--h3">Fixed width</h3>
<p class="docs-markdown--p">By default the width of the modal dialog is <code>736px</code>. You can change this behavior by setting the <code>width</code> property in the <code>NxModalConfig</code>.</p>
<div nx-docs-example="modal-fixed-width" config="{}">exampleID: modal-fixed-width</div>
<h3 id="modal-with-status" tabindex="-1" class="docs-markdown--h3">Modal with status</h3>
<p class="docs-markdown--p">Below is an example of how to create a modal with status by using the <code>nxModalTitle</code></p>
 <div nx-docs-example="modal-status" config="{}">exampleID: modal-status</div>
<h3 id="fullscreen" tabindex="-1" class="docs-markdown--h3">Fullscreen</h3>
<p class="docs-markdown--p">Set <code>fullscreen</code> to <code>true</code> to show the modal in fullscreen. When using <code>fullscreen</code> the <code>width</code>, <code>height</code>, <code>maxWidth</code> and <code>maxHeight</code> are overwritten.</p>
<div nx-docs-example="modal-fullscreen" config="{}">exampleID: modal-fullscreen</div>
<h3 id="configuration" tabindex="-1" class="docs-markdown--h3">Configuration</h3>
<p class="docs-markdown--p">Every dialog is opened with a default configuration. By passing a second parameter (<code>NxModalConfig</code> object) when opening a modal you can overwrite this configuration. Configurable are settings such as the dialog width and height, closing on backdrop click, adding additional classses to the dialog container etc. For more details on all configurable properties check out the <code>NxModalConfig</code> documentation <a href="./documentation/modal/api#NxModalConfig">here</a>.</p>
<p class="docs-markdown--p">You can also share data with your dialog via the configuration object:</p>
<pre><code class="language-ts"><span class="hljs-keyword">let</span> dialogRef = dialog.<span class="hljs-title function_">open</span>(<span class="hljs-title class_">YourDialog</span>, {
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Max Mustermann&#x27;</span> },
});
</code></pre>
<p class="docs-markdown--p">In your dialog you can access this data by injecting the <code>NX_MODAL_DATA</code> token:</p>
<pre><code class="language-ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">Inject</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">NX_MODAL_DATA</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@aposin/ng-aquila/modal&#x27;</span>;

<span class="hljs-meta">@Component</span>({
    <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;your-dialog&#x27;</span>,
    <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;passed in {{ data.name }}&#x27;</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YourDialog</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-meta">@Inject</span>(NX_MODAL_DATA) <span class="hljs-keyword">readonly</span> <span class="hljs-attr">data</span>: <span class="hljs-built_in">any</span></span>) {}
}
</code></pre>
<p class="docs-markdown--p">If you are using a template for the content of your dialog the data object will be available implicitly in your template as shown in the example below:</p>
<div nx-docs-example="modal-data-injection" config="{}">exampleID: modal-data-injection</div>
<h3 id="global-settings" tabindex="-1" class="docs-markdown--h3">Global Settings</h3>
<p class="docs-markdown--p">You can also overwrite the default dialog configuration by using the NX_MODAL_DEFAULT_CONFIG injection token as shown in the code snippet below:</p>
<pre><code class="language-ts"><span class="hljs-meta">@NgModule</span>({
  <span class="hljs-attr">providers</span>: [
    {
        <span class="hljs-attr">provide</span>: <span class="hljs-variable constant_">NX_MODAL_DEFAULT_OPTIONS</span>,
        <span class="hljs-attr">useValue</span>: { <span class="hljs-attr">width</span>: 700px, <span class="hljs-attr">showCloseIcon</span>: <span class="hljs-literal">true</span>}
    }
  ]
</code></pre>
<p class="docs-markdown--p">If you want to use a custom scroll strategy, you can use the <code>NX_MODAL_SCROLL_STRATEGY</code> injection token with a factory provider. The <code>Overlay</code> service from <code>@angular/cdk/overlay</code> offers 4 different scroll strategy options:</p>
<ul class="docs-markdown--ul">
<li class="docs-markdown--li"><strong>reposition:</strong> allow background scroll, the overlay moves with the background (default).</li>
<li class="docs-markdown--li"><strong>close:</strong> allow background scroll, closes the overlay on scroll.</li>
<li class="docs-markdown--li"><strong>block:</strong> disallow background scroll, the overlay does not move.</li>
<li class="docs-markdown--li"><strong>noop:</strong> allow background scroll, the overlay does not move.</li>
</ul>
<pre><code class="language-ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">scrollStrategyFactory</span>(<span class="hljs-params"><span class="hljs-attr">overlay</span>: <span class="hljs-title class_">Overlay</span></span>): <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">ScrollStrategy</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> overlay.<span class="hljs-property">scrollStrategies</span>.<span class="hljs-title function_">close</span>();
}

<span class="hljs-meta">@NgModule</span>({
  <span class="hljs-comment">/* ... */</span>
  <span class="hljs-attr">providers</span>: [{
    <span class="hljs-attr">provide</span>: <span class="hljs-variable constant_">NX_MODAL_SCROLL_STRATEGY</span>,
    <span class="hljs-attr">useFactory</span>: scrollStrategyFactory,
    <span class="hljs-attr">deps</span>: [<span class="hljs-title class_">Overlay</span>],
  }],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> {}
</code></pre>
<p class="docs-markdown--p">Alternatively, the <code>NX_MODAL_SCROLL_STRATEGY</code> injection token can be provided by importing <code>NxScrollStrategyModule.withConfig({ ... })</code> into your application or feature module, after your other aquila imports.</p>
<p class="docs-markdown--p">If you want to allow exceptions for setting inert attribute, you can use the <code>INERT_EXCEPTION_SELECTORS</code> injection token with a provider.</p>
<pre><code class="language-ts"><span class="hljs-meta">@NgModule</span>({
  <span class="hljs-comment">/* ... */</span>
  <span class="hljs-attr">providers</span>: [{
    <span class="hljs-attr">provide</span>: <span class="hljs-variable constant_">INERT_EXCEPTION_SELECTORS</span>,
    useValue : [<span class="hljs-string">&#x27;#onetrust-consent-sdk&#x27;</span>,<span class="hljs-string">&#x27;#your-id-selector&#x27;</span>,<span class="hljs-string">&#x27;.your-class-selector&#x27;</span>]
  }],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> {}
</code></pre>
<h3 id="directionality" tabindex="-1" class="docs-markdown--h3">Directionality</h3>
<p class="docs-markdown--p">By default all dialogs are rendered with <code>ltr</code> direction. If you need the dialog to use your application locale direction, for example when you need to support RTL scripts, you can use the <code>direction</code> configuration property.</p>
<p class="docs-markdown--p">To get your app direction we recommend using <a href="https://material.angular.io/cdk/bidi/overview">Directionality</a> from Angular CDK.</p>
<div nx-docs-example="modal-with-direction" config="{}">exampleID: modal-with-direction</div>
<h3 id="block-modal-closing" tabindex="-1" class="docs-markdown--h3">Block modal closing</h3>
<p class="docs-markdown--p">The following example demonstrates the usage of the <code>shouldClose</code> and <code>closeDenied</code> APIs to create a modal that displays a popover notification when attempting to close the modal with unsaved data.</p>
 <div nx-docs-example="modal-unsaved" config="{}">exampleID: modal-unsaved</div>
<h3 id="autofocus" tabindex="-1" class="docs-markdown--h3">Autofocus</h3>
<p class="docs-markdown--p">The <code>autofocus</code> property allows you to control which element receives focus when a modal is opened. The following options are available:</p>
<ul class="docs-markdown--ul">
<li class="docs-markdown--li"><code>dialog</code> or <code>false</code>: Focuses on the modal dialog itself.</li>
<li class="docs-markdown--li"><code>first-tabbable</code> or <code>true</code>: Focuses on the first tabbable element, such as a button (this is the default behavior).</li>
<li class="docs-markdown--li"><code>first-header</code>: Focuses on the first header element (e.g., <code>h1</code>, <code>h2</code>, <code>h3</code>).</li>
<li class="docs-markdown--li">Custom CSS selectors: You can specify a custom element to focus using a selector like <code>div</code> or <code>.element</code>.</li>
</ul>
 <div nx-docs-example="modal-autofocus" config="{}">exampleID: modal-autofocus</div>
<h3 id="accessibility" tabindex="-1" class="docs-markdown--h3">Accessibility</h3>
<p class="docs-markdown--p">By default, each modal has <code>role=&quot;dialog&quot;</code> on the root element. The role can be changed to <code>alertdialog</code> via the <code>NxModalConfig</code>.</p>
<p class="docs-markdown--p">The aria-label, aria-labelledby, and aria-describedby attributes of the modal as well as the aria-label of the optional close button can be set via the <code>NxModalConfig</code> as well. It is recommended to at least give a modal an aria-label or aria-labelledby attribute. (<strong>Note:</strong> <code>aria-label</code> or <code>aria-labelledby</code> is required for <em>Voiceover</em>. )</p>
<p class="docs-markdown--p">When a dialog opens, the first focusable element will be focused. The CdkOverlay used in the dialog traps the focus in itself in order to prevent users from interacting with elements in the background. Per default, the focus will be given back to the element which has been focused before the opening of the dialog.</p>
<p class="docs-markdown--p">Pressing the escape key will close the dialog per default. You can disable this behaviour by setting the <code>disabledClose</code> option to false in the <code>NxModalConfig</code>, but it is recommended to keep it on as it is the expected behaviour of a modal dialog.</p>
<h4 id="scrollable-areas-and-long-content" tabindex="-1" class="docs-markdown--h4">Scrollable areas and long content</h4>
<p class="docs-markdown--p">Non interactive scrollable areas and long content in size restricted containers can be problematic for keyboard users. <a href="/documentation/accessibility/overview#scroll-containers-and-keyboard-navigation">Have a look into our general accessibility guide on that.</a> TLDR: setting <code>tabindex=&quot;0&quot;</code> on the scrollable container is a valid workaround until this will be supported natively by browsers.</p>
<h3 id="deprecated-modal-component" tabindex="-1" class="docs-markdown--h3">Deprecated Modal Component</h3>
<p class="docs-markdown--p">The example below shows the previous implementation of the modal dialog, which is already deprecated and should not be used.</p>
<p class="docs-markdown--p">For using it you have to import the <code>NxModalModule</code> as follows:</p>
<pre><code class="language-ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NxModalModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@aposin/ng-aquila/modal&#x27;</span>;

<span class="hljs-meta">@NgModule</span>({
    <span class="hljs-attr">imports</span>: [
        <span class="hljs-title class_">NxModalModule</span>.<span class="hljs-title function_">forRoot</span>()
  ]
})
</code></pre>
<div nx-docs-example="modal-basic" config="{}">exampleID: modal-basic</div>
