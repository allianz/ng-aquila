import{c as se}from"./chunk-XWZ3CBJE.js";import{a as E,d as Ie,e as Ae}from"./chunk-VG47SEOV.js";import{c as q,q as Y,r as we}from"./chunk-CZQUVKYV.js";import{a as W}from"./chunk-PFMJ6XLP.js";import{y as Te}from"./chunk-2QTNUDAQ.js";import{A as u,Ad as P,B as I,Bb as H,Bd as ke,Cc as T,E as Z,Fd as z,Gc as me,Gd as $,Hb as S,Hc as Ce,Ib as j,Ic as Ne,J as fe,Jb as _,Jc as Q,Kc as F,Lb as k,Lc as R,Mc as be,O as J,Oc as Ee,P as ee,Pa as V,Pb as ie,Ra as x,Rc as ne,S as C,V as _e,a as O,b as K,bd as w,ca as te,cc as N,d as ce,da as A,ea as g,ga as L,l as m,m as v,na as B,pa as pe,pd as b,qc as xe,r as he,ra as c,rc as ye,vb as ge,vc as U,w as h,wd as Me,y as ue,yb as ve,yc as De,zb as f}from"./chunk-JYEJ3VMB.js";var re=class{dataNodes;expansionModel=new se(!0);trackBy;getLevel;isExpandable;getChildren;toggle(o){this.expansionModel.toggle(this._trackByValue(o))}expand(o){this.expansionModel.select(this._trackByValue(o))}collapse(o){this.expansionModel.deselect(this._trackByValue(o))}isExpanded(o){return this.expansionModel.isSelected(this._trackByValue(o))}toggleDescendants(o){this.expansionModel.isSelected(this._trackByValue(o))?this.collapseDescendants(o):this.expandDescendants(o)}collapseAll(){this.expansionModel.clear()}expandDescendants(o){let e=[o];e.push(...this.getDescendants(o)),this.expansionModel.select(...e.map(t=>this._trackByValue(t)))}collapseDescendants(o){let e=[o];e.push(...this.getDescendants(o)),this.expansionModel.deselect(...e.map(t=>this._trackByValue(t)))}_trackByValue(o){return this.trackBy?this.trackBy(o):o}},G=class extends re{getLevel;isExpandable;options;constructor(o,e,t){super(),this.getLevel=o,this.isExpandable=e,this.options=t,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(o){let e=this.dataNodes.indexOf(o),t=[];for(let i=e+1;i<this.dataNodes.length&&this.getLevel(o)<this.getLevel(this.dataNodes[i]);i++)t.push(this.dataNodes[i]);return t}expandAll(){this.expansionModel.select(...this.dataNodes.map(o=>this._trackByValue(o)))}};var Ve=new pe("CDK_TREE_NODE_OUTLET_NODE"),Le=(()=>{class s{viewContainer=c(H);_node=c(Ve,{optional:!0});constructor(){}static \u0275fac=function(t){return new(t||s)};static \u0275dir=_({type:s,selectors:[["","cdkTreeNodeOutlet",""]]})}return s})(),oe=class{$implicit;level;index;count;constructor(o){this.$implicit=o}},X=(()=>{class s{template=c(ge);when;constructor(){}static \u0275fac=function(t){return new(t||s)};static \u0275dir=_({type:s,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:[0,"cdkTreeNodeDefWhen","when"]}})}return s})();function Se(){return Error("Could not find a tree control, levelAccessor, or childrenAccessor for the tree.")}var y=(()=>{class s{_differs=c(ke);_changeDetectorRef=c(P);_elementRef=c(x);_dir=c(E);_onDestroy=new m;_dataDiffer;_defaultNodeDef;_dataSubscription;_levels=new Map;_parents=new Map;_ariaSets=new Map;get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}_dataSource;treeControl;levelAccessor;childrenAccessor;trackBy;expansionKey;_nodeOutlet;_nodeDefs;viewChange=new v({start:0,end:Number.MAX_VALUE});_expansionModel;_flattenedNodes=new v([]);_nodeType=new v(null);_nodes=new v(new Map);_keyManagerNodes=new v([]);_keyManagerFactory=c(we);_keyManager;_viewInit=!1;constructor(){}ngAfterContentInit(){this._initializeKeyManager()}ngAfterContentChecked(){this._updateDefaultNodeDefinition(),this._subscribeToDataChanges()}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),this._keyManager?.destroy()}ngOnInit(){this._checkTreeControlUsage(),this._initializeDataDiffer()}ngAfterViewInit(){this._viewInit=!0}_updateDefaultNodeDefinition(){let e=this._nodeDefs.filter(t=>!t.when);e.length>1,this._defaultNodeDef=e[0]}_setNodeTypeIfUnset(e){this._nodeType.value===null&&this._nodeType.next(e)}_switchDataSource(e){this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),e||this._nodeOutlet.viewContainer.clear(),this._dataSource=e,this._nodeDefs&&this._subscribeToDataChanges()}_getExpansionModel(){return this.treeControl?this.treeControl.expansionModel:(this._expansionModel??=new se(!0),this._expansionModel)}_subscribeToDataChanges(){if(this._dataSubscription)return;let e;Ae(this._dataSource)?e=this._dataSource.connect(this):ue(this._dataSource)?e=this._dataSource:Array.isArray(this._dataSource)&&(e=h(this._dataSource)),e&&(this._dataSubscription=this._getRenderData(e).pipe(g(this._onDestroy)).subscribe(t=>{this._renderDataChanges(t)}))}_getRenderData(e){let t=this._getExpansionModel();return I([e,this._nodeType,t.changed.pipe(te(null),L(i=>{this._emitExpansionChanges(i)}))]).pipe(A(([i,n])=>n===null?h({renderNodes:i,flattenedNodes:null,nodeType:n}):this._computeRenderingData(i,n).pipe(u(r=>K(O({},r),{nodeType:n})))))}_renderDataChanges(e){if(e.nodeType===null){this.renderNodeChanges(e.renderNodes);return}this._updateCachedData(e.flattenedNodes),this.renderNodeChanges(e.renderNodes),this._updateKeyManagerItems(e.flattenedNodes)}_emitExpansionChanges(e){if(!e)return;let t=this._nodes.value;for(let i of e.added)t.get(i)?._emitExpansionState(!0);for(let i of e.removed)t.get(i)?._emitExpansionState(!1)}_initializeKeyManager(){let e=I([this._keyManagerNodes,this._nodes]).pipe(u(([i,n])=>i.reduce((r,a)=>{let d=n.get(this._getExpansionKey(a));return d&&r.push(d),r},[]))),t={trackBy:i=>this._getExpansionKey(i.data),skipPredicate:i=>!!i.isDisabled,typeAheadDebounceInterval:!0,horizontalOrientation:this._dir.value};this._keyManager=this._keyManagerFactory(e,t)}_initializeDataDiffer(){let e=this.trackBy??((t,i)=>this._getExpansionKey(i));this._dataDiffer=this._differs.find([]).create(e)}_checkTreeControlUsage(){}renderNodeChanges(e,t=this._dataDiffer,i=this._nodeOutlet.viewContainer,n){let r=t.diff(e);!r&&!this._viewInit||(r?.forEachOperation((a,d,l)=>{if(a.previousIndex==null)this.insertNode(e[l],l,i,n);else if(l==null)i.remove(d);else{let D=i.get(d);i.move(D,l)}}),r?.forEachIdentityChange(a=>{let d=a.item;if(a.currentIndex!=null){let l=i.get(a.currentIndex);l.context.$implicit=d}}),n?this._changeDetectorRef.markForCheck():this._changeDetectorRef.detectChanges())}_getNodeDef(e,t){if(this._nodeDefs.length===1)return this._nodeDefs.first;let i=this._nodeDefs.find(n=>n.when&&n.when(t,e))||this._defaultNodeDef;return i}insertNode(e,t,i,n){let r=this._getLevelAccessor(),a=this._getNodeDef(e,t),d=this._getExpansionKey(e),l=new oe(e);l.index=t,n??=this._parents.get(d)??void 0,r?l.level=r(e):n!==void 0&&this._levels.has(this._getExpansionKey(n))?l.level=this._levels.get(this._getExpansionKey(n))+1:l.level=0,this._levels.set(d,l.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(a.template,l,t),p.mostRecentTreeNode&&(p.mostRecentTreeNode.data=e)}isExpanded(e){return!!(this.treeControl?.isExpanded(e)||this._expansionModel?.isSelected(this._getExpansionKey(e)))}toggle(e){this.treeControl?this.treeControl.toggle(e):this._expansionModel&&this._expansionModel.toggle(this._getExpansionKey(e))}expand(e){this.treeControl?this.treeControl.expand(e):this._expansionModel&&this._expansionModel.select(this._getExpansionKey(e))}collapse(e){this.treeControl?this.treeControl.collapse(e):this._expansionModel&&this._expansionModel.deselect(this._getExpansionKey(e))}toggleDescendants(e){this.treeControl?this.treeControl.toggleDescendants(e):this._expansionModel&&(this.isExpanded(e)?this.collapseDescendants(e):this.expandDescendants(e))}expandDescendants(e){if(this.treeControl)this.treeControl.expandDescendants(e);else if(this._expansionModel){let t=this._expansionModel;t.select(this._getExpansionKey(e)),this._getDescendants(e).pipe(C(1),g(this._onDestroy)).subscribe(i=>{t.select(...i.map(n=>this._getExpansionKey(n)))})}}collapseDescendants(e){if(this.treeControl)this.treeControl.collapseDescendants(e);else if(this._expansionModel){let t=this._expansionModel;t.deselect(this._getExpansionKey(e)),this._getDescendants(e).pipe(C(1),g(this._onDestroy)).subscribe(i=>{t.deselect(...i.map(n=>this._getExpansionKey(n)))})}}expandAll(){this.treeControl?this.treeControl.expandAll():this._expansionModel&&this._forEachExpansionKey(e=>this._expansionModel?.select(...e))}collapseAll(){this.treeControl?this.treeControl.collapseAll():this._expansionModel&&this._forEachExpansionKey(e=>this._expansionModel?.deselect(...e))}_getLevelAccessor(){return this.treeControl?.getLevel?.bind(this.treeControl)??this.levelAccessor}_getChildrenAccessor(){return this.treeControl?.getChildren?.bind(this.treeControl)??this.childrenAccessor}_getDirectChildren(e){let t=this._getLevelAccessor(),i=this._expansionModel??this.treeControl?.expansionModel;if(!i)return h([]);let n=this._getExpansionKey(e),r=i.changed.pipe(A(d=>d.added.includes(n)?h(!0):d.removed.includes(n)?h(!1):he),te(this.isExpanded(e)));if(t)return I([r,this._flattenedNodes]).pipe(u(([d,l])=>d?this._findChildrenByLevel(t,l,e,1):[]));let a=this._getChildrenAccessor();if(a)return Y(a(e)??[]);throw Se()}_findChildrenByLevel(e,t,i,n){let r=this._getExpansionKey(i),a=t.findIndex(M=>this._getExpansionKey(M)===r),d=e(i),l=d+n,D=[];for(let M=a+1;M<t.length;M++){let le=e(t[M]);if(le<=d)break;le<=l&&D.push(t[M])}return D}_registerNode(e){this._nodes.value.set(this._getExpansionKey(e.data),e),this._nodes.next(this._nodes.value)}_unregisterNode(e){this._nodes.value.delete(this._getExpansionKey(e.data)),this._nodes.next(this._nodes.value)}_getLevel(e){return this._levels.get(this._getExpansionKey(e))}_getSetSize(e){return this._getAriaSet(e).length}_getPositionInSet(e){let t=this._getAriaSet(e),i=this._getExpansionKey(e);return t.findIndex(n=>this._getExpansionKey(n)===i)+1}_getNodeParent(e){let t=this._parents.get(this._getExpansionKey(e.data));return t&&this._nodes.value.get(this._getExpansionKey(t))}_getNodeChildren(e){return this._getDirectChildren(e.data).pipe(u(t=>t.reduce((i,n)=>{let r=this._nodes.value.get(this._getExpansionKey(n));return r&&i.push(r),i},[])))}_sendKeydownToKeyManager(e){if(e.target===this._elementRef.nativeElement)this._keyManager.onKeydown(e);else{let t=this._nodes.getValue();for(let[,i]of t)if(e.target===i._elementRef.nativeElement){this._keyManager.onKeydown(e);break}}}_getDescendants(e){if(this.treeControl)return h(this.treeControl.getDescendants(e));if(this.levelAccessor){let t=this._findChildrenByLevel(this.levelAccessor,this._flattenedNodes.value,e,1/0);return h(t)}if(this.childrenAccessor)return this._getAllChildrenRecursively(e).pipe(J((t,i)=>(t.push(...i),t),[]));throw Se()}_getAllChildrenRecursively(e){return this.childrenAccessor?Y(this.childrenAccessor(e)).pipe(C(1),A(t=>{for(let i of t)this._parents.set(this._getExpansionKey(i),e);return h(...t).pipe(ee(i=>Z(h([i]),this._getAllChildrenRecursively(i))))})):h([])}_getExpansionKey(e){return this.expansionKey?.(e)??e}_getAriaSet(e){let t=this._getExpansionKey(e),i=this._parents.get(t),n=i?this._getExpansionKey(i):null;return this._ariaSets.get(n)??[e]}_findParentForNode(e,t,i){if(!i.length)return null;let n=this._levels.get(this._getExpansionKey(e))??0;for(let r=t-1;r>=0;r--){let a=i[r];if((this._levels.get(this._getExpansionKey(a))??0)<n)return a}return null}_flattenNestedNodesWithExpansion(e,t=0){let i=this._getChildrenAccessor();return i?h(...e).pipe(ee(n=>{let r=this._getExpansionKey(n);this._parents.has(r)||this._parents.set(r,null),this._levels.set(r,t);let a=Y(i(n));return Z(h([n]),a.pipe(C(1),L(d=>{this._ariaSets.set(r,[...d??[]]);for(let l of d??[]){let D=this._getExpansionKey(l);this._parents.set(D,n),this._levels.set(D,t+1)}}),A(d=>d?this._flattenNestedNodesWithExpansion(d,t+1).pipe(u(l=>this.isExpanded(n)?l:[])):h([]))))}),J((n,r)=>(n.push(...r),n),[])):h([...e])}_computeRenderingData(e,t){if(this.childrenAccessor&&t==="flat")return this._clearPreviousCache(),this._ariaSets.set(null,[...e]),this._flattenNestedNodesWithExpansion(e).pipe(u(i=>({renderNodes:i,flattenedNodes:i})));if(this.levelAccessor&&t==="nested"){let i=this.levelAccessor;return h(e.filter(n=>i(n)===0)).pipe(u(n=>({renderNodes:n,flattenedNodes:e})),L(({flattenedNodes:n})=>{this._calculateParents(n)}))}else return t==="flat"?h({renderNodes:e,flattenedNodes:e}).pipe(L(({flattenedNodes:i})=>{this._calculateParents(i)})):(this._clearPreviousCache(),this._ariaSets.set(null,[...e]),this._flattenNestedNodesWithExpansion(e).pipe(u(i=>({renderNodes:e,flattenedNodes:i}))))}_updateCachedData(e){this._flattenedNodes.next(e)}_updateKeyManagerItems(e){this._keyManagerNodes.next(e)}_calculateParents(e){let t=this._getLevelAccessor();if(t){this._clearPreviousCache();for(let i=0;i<e.length;i++){let n=e[i],r=this._getExpansionKey(n);this._levels.set(r,t(n));let a=this._findParentForNode(n,i,e);this._parents.set(r,a);let d=a?this._getExpansionKey(a):null,l=this._ariaSets.get(d)??[];l.splice(i,0,n),this._ariaSets.set(d,l)}}}_forEachExpansionKey(e){let t=[],i=[];this._nodes.value.forEach(n=>{t.push(this._getExpansionKey(n.data)),i.push(this._getDescendants(n.data))}),i.length>0?I(i).pipe(C(1),g(this._onDestroy)).subscribe(n=>{n.forEach(r=>r.forEach(a=>t.push(this._getExpansionKey(a)))),e(t)}):e(t)}_clearPreviousCache(){this._parents.clear(),this._levels.clear(),this._ariaSets.clear()}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=S({type:s,selectors:[["cdk-tree"]],contentQueries:function(t,i,n){if(t&1&&Ne(n,X,5),t&2){let r;F(r=R())&&(i._nodeDefs=r)}},viewQuery:function(t,i){if(t&1&&Q(Le,7),t&2){let n;F(n=R())&&(i._nodeOutlet=n.first)}},hostAttrs:["role","tree",1,"cdk-tree"],hostBindings:function(t,i){t&1&&T("keydown",function(r){return i._sendKeydownToKeyManager(r)})},inputs:{dataSource:"dataSource",treeControl:"treeControl",levelAccessor:"levelAccessor",childrenAccessor:"childrenAccessor",trackBy:"trackBy",expansionKey:"expansionKey"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,i){t&1&&U(0,0)},dependencies:[Le],encapsulation:2})}return s})(),p=(()=>{class s{_elementRef=c(x);_tree=c(y);_tabindex=-1;_type="flat";get role(){return"treeitem"}set role(e){}get isExpandable(){return this._isExpandable()}set isExpandable(e){this._inputIsExpandable=e,!(this.data&&!this._isExpandable||!this._inputIsExpandable)&&(this._inputIsExpanded?this.expand():this._inputIsExpanded===!1&&this.collapse())}get isExpanded(){return this._tree.isExpanded(this._data)}set isExpanded(e){this._inputIsExpanded=e,e?this.expand():this.collapse()}isDisabled;typeaheadLabel;getLabel(){return this.typeaheadLabel||this._elementRef.nativeElement.textContent?.trim()||""}activation=new ie;expandedChange=new ie;static mostRecentTreeNode=null;_destroyed=new m;_dataChanges=new m;_inputIsExpandable=!1;_inputIsExpanded=void 0;_shouldFocus=!0;_parentNodeAriaLevel;get data(){return this._data}set data(e){e!==this._data&&(this._data=e,this._dataChanges.next())}_data;get isLeafNode(){return this._tree.treeControl?.isExpandable!==void 0&&!this._tree.treeControl.isExpandable(this._data)?!0:this._tree.treeControl?.isExpandable===void 0&&this._tree.treeControl?.getDescendants(this._data).length===0}get level(){return this._tree._getLevel(this._data)??this._parentNodeAriaLevel}_isExpandable(){return this._tree.treeControl?!this.isLeafNode:this._inputIsExpandable}_getAriaExpanded(){return this._isExpandable()?String(this.isExpanded):null}_getSetSize(){return this._tree._getSetSize(this._data)}_getPositionInSet(){return this._tree._getPositionInSet(this._data)}_changeDetectorRef=c(P);constructor(){s.mostRecentTreeNode=this}ngOnInit(){this._parentNodeAriaLevel=He(this._elementRef.nativeElement),this._tree._getExpansionModel().changed.pipe(u(()=>this.isExpanded),_e(),g(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._tree._setNodeTypeIfUnset(this._type),this._tree._registerNode(this)}ngOnDestroy(){s.mostRecentTreeNode===this&&(s.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}getParent(){return this._tree._getNodeParent(this)??null}getChildren(){return this._tree._getNodeChildren(this)}focus(){this._tabindex=0,this._shouldFocus&&this._elementRef.nativeElement.focus(),this._changeDetectorRef.markForCheck()}unfocus(){this._tabindex=-1,this._changeDetectorRef.markForCheck()}activate(){this.isDisabled||this.activation.next(this._data)}collapse(){this.isExpandable&&this._tree.collapse(this._data)}expand(){this.isExpandable&&this._tree.expand(this._data)}makeFocusable(){this._tabindex=0,this._changeDetectorRef.markForCheck()}_focusItem(){this.isDisabled||this._tree._keyManager.focusItem(this)}_setActiveItem(){this.isDisabled||(this._shouldFocus=!1,this._tree._keyManager.focusItem(this),this._shouldFocus=!0)}_emitExpansionState(e){this.expandedChange.emit(e)}static \u0275fac=function(t){return new(t||s)};static \u0275dir=_({type:s,selectors:[["cdk-tree-node"]],hostAttrs:["role","treeitem",1,"cdk-tree-node"],hostVars:5,hostBindings:function(t,i){t&1&&T("click",function(){return i._setActiveItem()})("focus",function(){return i._focusItem()}),t&2&&(De("tabIndex",i._tabindex),N("aria-expanded",i._getAriaExpanded())("aria-level",i.level+1)("aria-posinset",i._getPositionInSet())("aria-setsize",i._getSetSize()))},inputs:{role:"role",isExpandable:[2,"isExpandable","isExpandable",z],isExpanded:"isExpanded",isDisabled:[2,"isDisabled","isDisabled",z],typeaheadLabel:[0,"cdkTreeNodeTypeaheadLabel","typeaheadLabel"]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["cdkTreeNode"]})}return s})();function He(s){let o=s.parentElement;for(;o&&!je(o);)o=o.parentElement;return o?o.classList.contains("cdk-nested-tree-node")?$(o.getAttribute("aria-level")):0:-1}function je(s){let o=s.classList;return!!(o?.contains("cdk-nested-tree-node")||o?.contains("cdk-tree"))}var Ue=/([A-Za-z%]+)$/,ht=(()=>{class s{_treeNode=c(p);_tree=c(y);_element=c(x);_dir=c(E,{optional:!0});_currentPadding;_destroyed=new m;indentUnits="px";get level(){return this._level}set level(e){this._setLevelInput(e)}_level;get indent(){return this._indent}set indent(e){this._setIndentInput(e)}_indent=40;constructor(){this._setPadding(),this._dir?.change.pipe(g(this._destroyed)).subscribe(()=>this._setPadding(!0)),this._treeNode._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){let e=(this._treeNode.data&&this._tree._getLevel(this._treeNode.data))??null,t=this._level==null?e:this._level;return typeof t=="number"?`${t*this._indent}${this.indentUnits}`:null}_setPadding(e=!1){let t=this._paddingIndent();if(t!==this._currentPadding||e){let i=this._element.nativeElement,n=this._dir&&this._dir.value==="rtl"?"paddingRight":"paddingLeft",r=n==="paddingLeft"?"paddingRight":"paddingLeft";i.style[n]=t||"",i.style[r]="",this._currentPadding=t}}_setLevelInput(e){this._level=isNaN(e)?null:e,this._setPadding()}_setIndentInput(e){let t=e,i="px";if(typeof e=="string"){let n=e.split(Ue);t=n[0],i=n[1]||i}this.indentUnits=i,this._indent=$(t),this._setPadding()}static \u0275fac=function(t){return new(t||s)};static \u0275dir=_({type:s,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:[2,"cdkTreeNodePadding","level",$],indent:[0,"cdkTreeNodePaddingIndent","indent"]}})}return s})(),ae=(()=>{class s{_tree=c(y);_treeNode=c(p);recursive=!1;constructor(){}_toggle(){this.recursive?this._tree.toggleDescendants(this._treeNode.data):this._tree.toggle(this._treeNode.data),this._tree._keyManager.focusItem(this._treeNode)}static \u0275fac=function(t){return new(t||s)};static \u0275dir=_({type:s,selectors:[["","cdkTreeNodeToggle",""]],hostAttrs:["tabindex","-1"],hostBindings:function(t,i){t&1&&T("click",function(r){return i._toggle(),r.stopPropagation()})("keydown.Enter",function(r){return i._toggle(),r.preventDefault()})("keydown.Space",function(r){return i._toggle(),r.preventDefault()})},inputs:{recursive:[2,"cdkTreeNodeToggleRecursive","recursive",z]}})}return s})();var Fe=(()=>{class s{static \u0275fac=function(t){return new(t||s)};static \u0275mod=j({type:s});static \u0275inj=B({})}return s})();var ze=["*"],Re=(()=>{class s{constructor(e,t){this._elementRef=e,this._treeNode=t}focus(){this._elementRef.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||s)(f(x),f(p))}}static{this.\u0275dir=_({type:s,selectors:[["","nxTreeNodeActionItem",""]],hostVars:5,hostBindings:function(t,i){t&2&&N("tabindex",-1)("role","treeitem")("aria-level",(i._treeNode==null?null:i._treeNode.level)+1)("aria-posinset",i._treeNode==null?null:i._treeNode._getPositionInSet())("aria-setsize",i._treeNode==null?null:i._treeNode._getSetSize())}})}}return s})(),de=class{transformFunction(o,e){let n=o,{children:t}=n,i=ce(n,["children"]);return K(O({},i),{level:e,expandable:Array.isArray(t)&&t.length>0})}getLevel(o){return o.level}isExpandable(o){return o.expandable}getChildren(o){return o.children}_flattenNode(o,e,t,i){let n=this.transformFunction(o,e);if(t.push(n),this.isExpandable(n)){let r=this.getChildren(o);Array.isArray(r)?this._flattenChildren(r,e,t,i):r.pipe(C(1)).subscribe(a=>{this._flattenChildren(a,e,t,i)})}return t}_flattenChildren(o,e,t,i){o.forEach((n,r)=>{let a=i.slice();a.push(r!==o.length-1),this._flattenNode(n,e+1,t,a)})}flattenNodes(o){let e=[];return o.forEach(t=>this._flattenNode(t,0,e,[])),e}expandFlattenedNodes(o,e){let t=[],i=[];return i[0]=!0,o.forEach(n=>{let r=!0;for(let a=0;a<=this.getLevel(n);a++)r=r&&i[a];r&&t.push(n),this.isExpandable(n)&&(i[this.getLevel(n)+1]=e.isExpanded(n))}),t}},Pe=class extends Ie{set data(o){this._data.next(o),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this.treeControl.dataNodes=this._flattenedData.value}get data(){return this._data.value}constructor(o,e=[]){super(),this.treeControl=o,this._flattenedData=new v([]),this._expandedData=new v([]),this._data=new v([]),this._treeFlattener=new de,this.data=e}connect(o){let e=[o.viewChange,this.treeControl.expansionModel.changed.asObservable(),this._flattenedData.asObservable()];return fe(...e).pipe(u(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this.treeControl)),this._expandedData.value)))}disconnect(){}},Oe=class extends G{constructor(){super(o=>o.level,o=>o.expandable)}},Bt=(()=>{class s extends p{constructor(e,t,i){super(e,t),this._focusMonitor=i,this.actionItem=Me(Re),this.tabIndex=b(()=>this.actionItem()?null:-1),this.ariaLevel=b(()=>this.actionItem()?null:this.level+1),this.ariaPosInSet=b(()=>this.actionItem()?null:this._getPositionInSet()),this.ariaSetSize=b(()=>this.actionItem()?null:this._getSetSize()),this.ariaRole=b(()=>this.actionItem()?null:"treeitem"),this.ariaExpanded=b(()=>this.actionItem()?null:this.isExpanded)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef.nativeElement)}ngAfterViewChecked(){this.actionItem()&&(this._elementRef.nativeElement.removeAttribute("aria-expanded"),this._elementRef.nativeElement.removeAttribute("tabIndex"))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef.nativeElement),super.ngOnDestroy()}_focus(){this._tree.updateFocusedData(this._data)}focus(){this.actionItem()?this.actionItem().focus?.():this._elementRef.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||s)(f(x),f(y),f(q))}}static{this.\u0275cmp=S({type:s,selectors:[["nx-tree-node"]],contentQueries:function(t,i,n){t&1&&be(n,i.actionItem,Re,5),t&2&&Ee()},hostAttrs:[1,"nx-tree__node"],hostVars:8,hostBindings:function(t,i){t&2&&(N("tabindex",i.tabIndex())("aria-level",i.ariaLevel())("aria-posinset",i.ariaPosInSet())("aria-setsize",i.ariaSetSize())("role",i.ariaRole())("aria-expanded",i.ariaExpanded()),ne("is-expanded",i.isExpanded))},inputs:{disabled:"disabled",tabIndex:"tabIndex"},exportAs:["nxTreeNode"],features:[w([{provide:p,useExisting:s}]),k],ngContentSelectors:ze,decls:2,vars:0,consts:[[1,"nx-tree__node-box"]],template:function(t,i){t&1&&(me(),xe(0,"div",0),Ce(1),ye())},encapsulation:2})}}return s})(),Vt=(()=>{class s extends X{static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=V(s)))(i||s)}})()}static{this.\u0275dir=_({type:s,selectors:[["","nxTreeNodeDef",""]],inputs:{when:[0,"nxTreeNodeDefWhen","when"],data:[0,"nxTreeNode","data"]},features:[w([{provide:X,useExisting:s}]),k]})}}return s})(),Ke=(()=>{class s{constructor(e){this.viewContainer=e}static{this.\u0275fac=function(t){return new(t||s)(f(H))}}static{this.\u0275dir=_({type:s,selectors:[["","nxTreeNodeOutlet",""]]})}}return s})(),$e=/([%A-Z]+)$/i,Ht=(()=>{class s{set level(e){this._level=W(e),this._setPadding()}get level(){return this._level}set offset(e){this._offset=W(e),this._setPadding()}get offset(){return this._offset}set indent(e){let t=e,i="px";if(typeof e=="string"){let n=e.split($e);t=n[0],i=n[1]||i}this.indentUnits=i,this._indent=W(t),this._setPadding()}get indent(){return this._indent}constructor(e,t,i,n,r){this._treeNode=e,this._tree=t,this._renderer=i,this._element=n,this._dir=r,this.indentUnits="px",this._offset=0,this._indent=24,this._destroyed=new m,this._setPadding(),this._dir&&this._dir.change.pipe(g(this._destroyed)).subscribe(()=>this._setPadding(!0)),e._dataChanges.pipe(g(this._destroyed)).subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){if(this._tree.treeControl){let e=this._treeNode.data&&this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._treeNode.data):null,t=this._level||e;return t?`${t*this._indent+this._offset}${this.indentUnits}`:null}return null}_setPadding(e=!1){let t=this._paddingIndent();if(t!==this._currentPadding||e){let i=this._element.nativeElement,n=this._dir&&this._dir.value==="rtl"?"paddingRight":"paddingLeft",r=n==="paddingLeft"?"paddingRight":"paddingLeft";this._renderer.setStyle(i,n,t),this._renderer.setStyle(i,r,null),this._currentPadding=t}}static{this.\u0275fac=function(t){return new(t||s)(f(p),f(y),f(ve),f(x),f(E,8))}}static{this.\u0275dir=_({type:s,selectors:[["","nxTreeNodePadding",""]],hostVars:2,hostBindings:function(t,i){t&2&&ne("nx-tree-node--with-padding",!0)},inputs:{level:[0,"nxTreeNodePadding","level"],offset:[0,"nxTreeNodePaddingOffset","offset"],indent:[0,"nxTreeNodePaddingIndent","indent"]}})}}return s})(),jt=(()=>{class s extends ae{static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=V(s)))(i||s)}})()}static{this.\u0275dir=_({type:s,selectors:[["","nxTreeNodeToggle",""]],hostVars:1,hostBindings:function(t,i){t&2&&N("aria-expanded",i._treeNode==null?null:i._treeNode.isExpanded)},inputs:{recursive:[0,"nxTreeNodeToggleRecursive","recursive"]},features:[w([{provide:ae,useExisting:s}]),k]})}}return s})(),Ut=(()=>{class s extends y{constructor(){super(...arguments),this._cdr=c(P),this.dir=c(E),this.elementRef=c(x),this._focusMonitor=c(q),this.nodeMap=new Map,this.childrenMap=new Map,this.parentMap=new Map,this._tabIndex=0,this._userTabIndex=null,this._wrapperOnDestroy=new m}set tabIndex(e){this._userTabIndex=e}ngOnInit(){super.ngOnInit(),this._monitorTreeFocus()}ngOnDestroy(){super.ngOnDestroy(),this._wrapperOnDestroy.next(),this._wrapperOnDestroy.complete()}get focusedData(){return this._focusedData}insertToA11yNodeTracking(e,t,i,n){this.nodeMap.set(t,i),n&&this.parentMap.set(t,n),this._getChildrenList(n).includes(t)||this._getChildrenList(n).splice(e,0,t)}removeFromA11yNodeTracking(e,t){let n=this._getChildrenList(t).splice(e,1)[0];n&&n===this._focusedData&&this._changeFocusedData(this._getNextVisibleNode()),this.nodeMap.delete(n),this.parentMap.delete(n),this.childrenMap.delete(n)}moveInA11yNodeTracking(e,t,i){let n=this._getChildrenList(i),r=n.splice(e,1);n.splice(t,0,r[0])}updateFocusedData(e){this._focusedData=e}focus(){this._focusedData?this._changeFocusedData(this._focusedData):this.focusFirstVisibleNode()}focusFirstVisibleNode(){this._changeFocusedData(this._getFirstVisibleNode())}focusLastVisibleNode(){this._changeFocusedData(this._getLastVisibleNode())}focusPreviousVisibleNode(){if(!this._focusedData)return this.focusLastVisibleNode();this._changeFocusedData(this._getPreviousVisibleNode())}focusNextVisibleNode(){if(!this._focusedData)return this.focusFirstVisibleNode();this._changeFocusedData(this._getNextVisibleNode())}collapseCurrentFocusedNode(){this._focusedData&&this.treeControl&&(this.treeControl.isExpanded(this._focusedData)?this.treeControl.collapse(this._focusedData):this._changeFocusedData(this._getParentNode()))}expandCurrentFocusedNode(){this._focusedData&&this.treeControl&&(this.treeControl.isExpanded(this._focusedData)?this._changeFocusedData(this._getNextVisibleNode()):this.treeControl.expand(this._focusedData))}expandAllNodes(){this.treeControl&&this.treeControl.expandAll()}toggleCurrentFocusedNode(){this._focusedData&&this.treeControl&&this.treeControl.toggle(this._focusedData)}_isRtl(){return this.dir&&this.dir.value==="rtl"}_handleKeydown(e){switch(e.keyCode){case 36:this.focusFirstVisibleNode(),e.preventDefault();break;case 35:this.focusLastVisibleNode(),e.preventDefault();break;case 38:this.focusPreviousVisibleNode(),e.preventDefault();break;case 40:this.focusNextVisibleNode(),e.preventDefault();break;case 37:this._isRtl()?this.expandCurrentFocusedNode():this.collapseCurrentFocusedNode(),e.preventDefault();break;case 39:this._isRtl()?this.collapseCurrentFocusedNode():this.expandCurrentFocusedNode(),e.preventDefault();break;case 106:this.expandAllNodes(),e.preventDefault();break;default:}}_changeFocusedData(e){e&&(this._focusedData=e,this.nodeMap.has(this._focusedData)&&this.nodeMap.get(this._focusedData).focus())}_getFirstVisibleNode(){return this._getChildrenList()[0]}_getLastVisibleNode(){let e=this._getChildrenList();return this._getLastChild(e[e.length-1])}_getPreviousVisibleNode(){if(this._focusedData&&this.treeControl){let e=this.parentMap.get(this._focusedData),t=this.childrenMap.get(e),i=t.indexOf(this._focusedData);if(this.treeControl.isExpanded(this._focusedData)||this._removeChildren(),i===0)return e;if(i>0)return this._getLastChild(t[i-1])}}_getNextVisibleNode(){if(this._focusedData&&this.treeControl){let e=this.treeControl.isExpanded(this._focusedData);if(e||this._removeChildren(),this.childrenMap.has(this._focusedData)&&this.treeControl&&e){let i=this._getChildrenList(this._focusedData);if(i.length)return i[0]}let t=this._focusedData;for(;t;){let i=this.parentMap.get(t),n=this.childrenMap.get(i),r=n.indexOf(t);if(r===n.length-1)t=i;else if(r>-1)return n[r+1]}}}_getParentNode(){if(this.parentMap.has(this._focusedData))this._changeFocusedData(this.parentMap.get(this._focusedData));else if(this.treeControl&&this.treeControl.getLevel){let e=this._getChildrenList(),t=e.indexOf(this._focusedData),i=this.treeControl.getLevel(this._focusedData)-1;if(t<=0)return;for(let n=t-1;n>=0;n--)if(this.treeControl.getLevel(e[n])===i)return e[n]}}_removeChildren(){let e=this.parentMap.get(this._focusedData),t=this._getChildrenList(),i=t.indexOf(this._focusedData),n=this._getNestLevels(t,i);n.forEach(a=>{this.nodeMap.delete(a),this.parentMap.delete(a)});let r=t.filter(a=>!n.includes(a));this.childrenMap.set(e,r)}_getNestLevels(e,t){let i=e[t]?.level,n=[],r=t+1;for(;r<e.length;){let a=e[r];if(a.level<=i)break;n.push(a),r++}return n}_getChildrenList(e){return this.childrenMap.has(e)||this.childrenMap.set(e,[]),this.childrenMap.get(e)}_getLastChild(e){let t=e;for(;t&&this.childrenMap.has(t)&&this.treeControl&&this.treeControl.isExpanded(t);){let i=this._getChildrenList(t);if(i.length)t=i[i.length-1];else break}return t}insertNode(e,t,i,n){super.insertNode(e,t,i,n),p.mostRecentTreeNode&&this.insertToA11yNodeTracking(t,e,p.mostRecentTreeNode,n)}renderNodeChanges(e,t=this._dataDiffer,i=this._nodeOutlet.viewContainer,n){super.renderNodeChanges(e,t,i,n);let r=t.diff(e);r&&r.forEachOperation((a,d,l)=>{l==null?this.removeFromA11yNodeTracking(d,n):a.previousIndex!==null&&this.moveInA11yNodeTracking(d,l,n)})}_monitorTreeFocus(){this._focusMonitor.monitor(this.elementRef.nativeElement,!0).pipe(g(this._wrapperOnDestroy)).subscribe(e=>{let t=e?-1:this._userTabIndex||0;this._tabIndex!==t&&(this._tabIndex=t,this._cdr.markForCheck())})}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=V(s)))(i||s)}})()}static{this.\u0275cmp=S({type:s,selectors:[["nx-tree"]],viewQuery:function(t,i){if(t&1&&Q(Ke,7),t&2){let n;F(n=R())&&(i._nodeOutlet=n.first)}},hostAttrs:["role","tree",1,"nx-tree","cdk-tree"],hostVars:1,hostBindings:function(t,i){t&1&&T("keydown",function(r){return i._handleKeydown(r)})("focus",function(){return i.focus()}),t&2&&N("tabindex",i._tabIndex)},inputs:{tabIndex:"tabIndex"},exportAs:["nxTree"],features:[w([{provide:y,useExisting:s}]),k],decls:1,vars:0,consts:[["nxTreeNodeOutlet",""]],template:function(t,i){t&1&&U(0,0)},dependencies:[Ke],styles:[`:host.nx-tree{display:block}.nx-tree__node{display:block;overflow:hidden}.nx-tree__node.cdk-keyboard-focused{box-shadow:var(--focus-inset-box-shadow);border-radius:8px}@media screen and (forced-colors: active){.nx-tree__node.cdk-keyboard-focused{box-shadow:inset 0 0 0 4px CanvasText,inset 0 0 0 6px background;border:4px solid CanvasText}}
`],encapsulation:2,changeDetection:0})}}return s})(),Qt=(()=>{class s{static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275mod=j({type:s})}static{this.\u0275inj=B({imports:[Fe,Te]})}}return s})();export{X as a,y as b,p as c,ht as d,ae as e,Fe as f,Re as g,Pe as h,Oe as i,Bt as j,Vt as k,Ht as l,jt as m,Ut as n,Qt as o};
