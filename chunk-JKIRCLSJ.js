import{f as w,g as J,h as tt,k as R,l as et,m as it,p as d,s as k}from"./chunk-K5HKQF4M.js";import{a as C}from"./chunk-TBGGIU33.js";import{b as Q,h as q,l as K}from"./chunk-JENZ4ZLG.js";import{A as Z,l as U,u as z}from"./chunk-SRJVIWAL.js";import{d as G}from"./chunk-MOKCFCZL.js";import{A as F,I as T,Kc as H,L as g,Lb as x,Na as v,Ra as B,Rb as M,Sb as N,a as c,da as u,la as b,m as h,ma as D,oa as S,qa as l,ra as j,vb as _,vc as $,wa as A,wc as V,xa as L,xb as X,xc as W,ya as Y}from"./chunk-BR37RZFV.js";function lt(i,s){}var ct=["top","bottom"],ht=["left","right"],ut=["top","right","bottom","left"],dt=0,m=class{constructor(){this.role=null,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="",this.closeOnClickOutside=!0,this.width="",this.height="",this.maxWidth="",this.direction="bottom",this.fallbackOrientation="clockwise",this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}};function I(){throw Error("Attempting to attach overlay content after content is already attached")}var rt=(()=>{let s=class s extends tt{constructor(t,e,r,o){super(),this._elementRef=t,this._focusTrapFactory=e,this._document=r,this._config=o,this._elementFocusedBeforeDialogWasOpened=null,this.attachDomPortal=a=>(this._portalOutlet.hasAttached()&&I(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachDomPortal(a)),this._ariaLabelledBy=o.ariaLabelledBy||null}get elementRef(){return this._elementRef}attachComponentPortal(t){return this._portalOutlet.hasAttached()&&I(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached()&&I(),this._trapFocus(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachTemplatePortal(t)}_trapFocus(){let t=this._elementRef.nativeElement;if(this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(t)),this._config.autoFocus)this._focusTrap.focusInitialElementWhenReady();else{let e=this._document?.activeElement;e!==t&&!t.contains(e)&&t.focus()}}restoreFocus(){let t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&typeof t.focus=="function"){let e=this._document?.activeElement,r=this._elementRef.nativeElement;(!e||e===this._document?.body||e===r||r.contains(e))&&t.focus()}this._focusTrap&&this._focusTrap.destroy()}_savePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then(()=>this._elementRef.nativeElement.focus()))}};s.\u0275fac=function(e){return new(e||s)(_(B),_(z),_(G,8),_(m))},s.\u0275cmp=A({type:s,selectors:[["nx-overlay-container"]],viewQuery:function(e,r){if(e&1&&$(R,7),e&2){let o;V(o=W())&&(r._portalOutlet=o.first)}},hostAttrs:[1,"nx-overlay-container"],hostVars:5,hostBindings:function(e,r){e&2&&N("id",r._id)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},standalone:!0,features:[x,H],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,r){e&1&&M(0,lt,0,0,"ng-template",0)},dependencies:[R],styles:["[_nghost-%COMP%]{display:block;background-color:transparent;width:100%;height:100%}[_nghost-%COMP%]:focus{outline:none}@media screen and (forced-colors: active){[_nghost-%COMP%]{border:1px solid CanvasText;background:Canvas}}"]});let i=s;return i})(),ft=0,y=class{constructor(s,P,t,e,r=`nx-overlay-${ft++}`){this._overlayRef=s,this._containerInstance=P,this.origin=t,this._router=e,this.id=r,this.closeOnClickOutside=this._containerInstance._config.closeOnClickOutside,this._afterOpened=new h,this._afterClosed=new h,this._beforeClosed=new h,this._state=0,this._documentClickObservable=T(document,"click"),s.backdropClick().pipe(u(this._afterClosed)).subscribe(()=>{this.closeOnClickOutside&&this.close()}),setTimeout(()=>this.waitForClose()),this._router.events.pipe(u(this.afterClosed())).subscribe(o=>{o instanceof Q&&this.close()}),P._id=r,s.detachments().pipe(u(this._afterClosed)).subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),s.keydownEvents().pipe(g(o=>o.keyCode===27&&!U(o)),u(this._afterClosed)).subscribe(o=>{o.preventDefault(),this.close()}),this._afterOpened.next(),this._afterOpened.complete()}waitForClose(){this._documentClickObservable.pipe(F(s=>s.target),g(s=>!this._overlayRef.overlayElement?.contains(s)),u(this._afterClosed)).subscribe(()=>{this.closeOnClickOutside&&this.close()})}close(s){this._result=s,this._beforeClosed.next(s),this._beforeClosed.complete(),this._overlayRef.dispose(),this._state=1,this._containerInstance.restoreFocus(),this._containerInstance._config.triggerButton&&this._containerInstance._config.triggerButton.setTriggerInactive()}afterOpened(){return this._afterOpened.asObservable()}afterClosed(){return this._afterClosed.asObservable()}beforeClosed(){return this._beforeClosed.asObservable()}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}addPanelClass(s){return this._overlayRef.addPanelClass(s),this}removePanelClass(s){return this._overlayRef.removePanelClass(s),this}getState(){return this._state}};function f(i){return Error(`Overlay direction "${i}" is invalid.`)}var E={top(i){return{overlayX:"center",overlayY:"bottom"}},"top-start":function(i){return{overlayX:i?"end":"start",overlayY:"bottom"}},"top-end":function(i){return{overlayX:i?"start":"end",overlayY:"bottom"}},bottom(i){return{overlayX:"center",overlayY:"top"}},"bottom-start":function(i){return{overlayX:i?"end":"start",overlayY:"top"}},"bottom-end":function(i){return{overlayX:i?"start":"end",overlayY:"top"}},left(i){return{overlayX:i?"start":"end",overlayY:"center"}},right(i){return{overlayX:i?"end":"start",overlayY:"center"}}},st={top(i){return{originX:"center",originY:"top"}},"top-start":function(i){return{originX:i?"end":"start",originY:"top"}},"top-end":function(i){return{originX:i?"start":"end",originY:"top"}},bottom(i){return{originX:"center",originY:"bottom"}},"bottom-start":function(i){return{originX:i?"end":"start",originY:"bottom"}},"bottom-end":function(i){return{originX:i?"start":"end",originY:"bottom"}},left(i){return{originX:i?"end":"start",originY:"center"}},right(i){return{originX:i?"start":"end",originY:"center"}}},pt=(()=>{let s=class s{constructor(t,e){this._overlay=t,this._dir=e}createPositionStrategy(t,e){let r=this._getFallbackPositions(e.direction,e),o=this.getOrigin(e.direction),a=this.getOverlayPosition(e.direction),n=this.getOffset(e.direction,e);return this._overlay.position().flexibleConnectedTo(t).withPush(!1).withFlexibleDimensions(!0).withLockedPosition().withGrowAfterOpen().withPositions([c(c(c({},o),a),n),...r])}getOrigin(t){if(!t||!(t in st))throw f(t);return st[t](this.isRtl)}getOverlayPosition(t){if(!t||!(t in E))throw f(t);return E[t](this.isRtl)}getOffset(t,e){if(!t||!(t in E))throw f(t);let r=e.offset||dt,[o]=t.split("-");switch(o){case"top":return{offsetY:r*-1};case"bottom":return{offsetY:r};case"left":return{offsetX:r*-1};case"right":return{offsetX:r};default:throw f(t)}}_getFallbackPositions(t,e){if(!t)return[];let r=this._getFallbackOrder(t,e),o=this._resolveFallbacks(r,e).filter(n=>n!==t),a=[];return o.forEach(n=>{let p=this.getOrigin(n),O=this.getOverlayPosition(n),nt=this.getOffset(n,e);a.push(c(c(c({},p),O),nt))}),a}_getFallbackOrder(t,e){let r;switch(e.fallbackOrientation){case"vertical":r=ct;break;case"horizontal":r=ht;break;case"clockwise":r=ut;break;default:throw f(e.fallbackOrientation||"")}let[o]=this._splitDirection(t),a=r.indexOf(o);return[...r.slice(a),...r.slice(0,a)]}_splitDirection(t){return t.split("-")}get isRtl(){return this._dir?.value==="rtl"}_getInversePosition(t){return{top:"bottom",bottom:"top",start:"end",end:"start",center:"center"}[t]}_resolveFallbacks(t,e){if(!e.direction)throw f("");let[r,o]=this._splitDirection(e.direction);return t.reduce((a,n)=>(n==="top"||n==="bottom"?o?a.push(`${n}-${o}`,`${n}-${this._getInversePosition(o)}`,n):a.push(n,`${n}-start`,`${n}-end`):a.push(n),a),[])}};s.\u0275fac=function(e){return new(e||s)(l(d),l(C,8))},s.\u0275prov=b({token:s,factory:s.\u0275fac,providedIn:"root"});let i=s;return i})(),ot=new S("nx-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let i=j(d);return()=>i.scrollStrategies.reposition()}});function vt(i){return()=>i.scrollStrategies.reposition()}var _t={provide:ot,useFactory:vt,deps:[d]},mt=(()=>{let s=class s{constructor(t,e,r,o,a,n,p){this._overlay=t,this._injector=e,this._router=r,this._positionBuilder=o,this._parentOverlayService=a,this._dir=n,this._defaultScrollStrategyFactory=p,this._afterAllClosedAtThisLevel=new h,this._afterOpenedAtThisLevel=new h,this._openOverlaysAtThisLevel=[],this._scrollStrategyFactory=this._defaultScrollStrategyFactory}get openOverlays(){return this._parentOverlayService?this._parentOverlayService.openOverlays:this._openOverlaysAtThisLevel}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}open(t,e,r){if(r=yt(r,new m),r.id&&this.getOverlayById(r.id))throw Error(`Overlay with id "${r.id}" exists already. The overlay id must be unique.`);let o=this._createOverlay(r,e),a=this._attachOverlayContainer(o,r),n=this._attachOverlayContent(t,a,o,r,e);return this.openOverlays.push(n),n.afterClosed().subscribe(()=>this._removeOpenOverlay(n)),r.triggerButton&&r.triggerButton.setTriggerActive(),n}getOverlayById(t){return this.openOverlays.find(e=>e.id===t)}ngOnDestroy(){this._closeOverlays(this._openOverlaysAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t,e){let r=this._getOverlayConfig(t,e);return this._overlay.create(r)}_getOverlayConfig(t,e){let r=new it({positionStrategy:t.positionStrategy||this._positionBuilder.createPositionStrategy(e,t),scrollStrategy:t.scrollStrategy||this._scrollStrategyFactory(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,width:t.width,height:t.height,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation,direction:this.dir});return t.backdropClass&&(r.backdropClass=t.backdropClass),r}get isRtl(){return this._dir?.value==="rtl"}_attachOverlayContainer(t,e){let r=e?.viewContainerRef?.injector,o=v.create({parent:r||this._injector,providers:[{provide:m,useValue:e}]}),a=new w(rt,e.viewContainerRef,o,e.componentFactoryResolver);return t.attach(a).instance}_attachOverlayContent(t,e,r,o,a){let n=new y(r,e,a,this._router,o.id);if(t instanceof X)e.attachTemplatePortal(new J(t,null,{$implicit:n}));else{let p=this._createInjector(o,n,e),O=e.attachComponentPortal(new w(t,o.viewContainerRef,p));n.componentInstance=O.instance}return n}_createInjector(t,e,r){let o=t?.viewContainerRef?.injector,a=[{provide:rt,useValue:r},{provide:y,useValue:e}];return v.create({parent:o||this._injector,providers:a})}_removeOpenOverlay(t){let e=this.openOverlays.indexOf(t);e>-1&&this.openOverlays.splice(e,1)}_closeOverlays(t){let e=t.length;for(;e--;)t[e].close()}};s.\u0275fac=function(e){return new(e||s)(l(d),l(v),l(q),l(pt),l(s,12),l(C,8),l(ot))},s.\u0275prov=b({token:s,factory:s.\u0275fac,providedIn:"root"});let i=s;return i})();function yt(i,s){return c(c({},s),i)}var $t=(()=>{let s=class s{};s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=L({type:s}),s.\u0275inj=D({providers:[mt,_t],imports:[k,Z,et,K,k]});let i=s;return i})(),Vt=(()=>{let s=class s{};s.\u0275fac=function(e){return new(e||s)},s.\u0275dir=Y({type:s,standalone:!0});let i=s;return i})();export{mt as a,$t as b,Vt as c};
