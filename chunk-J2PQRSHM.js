import{f as w,g as z,h as Z,k as R,l as J,m as tt,p as d,s as k}from"./chunk-LJK2GACP.js";import{a as C}from"./chunk-T5NYCE37.js";import{b as H,h as G,l as Q}from"./chunk-YHRSJ234.js";import{b as q,m as K,s as U}from"./chunk-2EQ73B6L.js";import{d as W}from"./chunk-CCSED5RY.js";import{F,Fc as X,Ga as _,Gc as $,Hc as V,I as g,Lb as x,Mb as L,Nb as Y,Oa as j,Pb as B,Rb as N,a as c,ac as M,ba as u,j as h,ja as b,ka as T,ma as D,oa as l,pa as S,x as E,xb as v,zb as A}from"./chunk-LG2ZA55B.js";function nt(i,a){}var at=["top","bottom"],lt=["left","right"],ct=["top","right","bottom","left"],ht=0,m=class{constructor(){this.role=null,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="",this.closeOnClickOutside=!0,this.width="",this.height="",this.maxWidth="",this.direction="bottom",this.fallbackOrientation="clockwise",this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}};function I(){throw Error("Attempting to attach overlay content after content is already attached")}var et=(()=>{class i extends Z{constructor(t,e,r,o){super(),this._elementRef=t,this._focusTrapFactory=e,this._document=r,this._config=o,this._elementFocusedBeforeDialogWasOpened=null,this.attachDomPortal=s=>(this._portalOutlet.hasAttached()&&I(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachDomPortal(s)),this._ariaLabelledBy=o.ariaLabelledBy||null}get elementRef(){return this._elementRef}attachComponentPortal(t){return this._portalOutlet.hasAttached()&&I(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached()&&I(),this._trapFocus(),this._savePreviouslyFocusedElement(),this._portalOutlet.attachTemplatePortal(t)}_trapFocus(){let t=this._elementRef.nativeElement;if(this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(t)),this._config.autoFocus)this._focusTrap.focusInitialElementWhenReady();else{let e=this._document?.activeElement;e!==t&&!t.contains(e)&&t.focus()}}restoreFocus(){let t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&typeof t.focus=="function"){let e=this._document?.activeElement,r=this._elementRef.nativeElement;(!e||e===this._document?.body||e===r||r.contains(e))&&t.focus()}this._focusTrap&&this._focusTrap.destroy()}_savePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then(()=>this._elementRef.nativeElement.focus()))}static{this.\u0275fac=function(e){return new(e||i)(v(j),v(K),v(W,8),v(m))}}static{this.\u0275cmp=x({type:i,selectors:[["nx-overlay-container"]],viewQuery:function(e,r){if(e&1&&X(R,7),e&2){let o;$(o=V())&&(r._portalOutlet=o.first)}},hostAttrs:[1,"nx-overlay-container"],hostVars:5,hostBindings:function(e,r){e&2&&M("id",r._id)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},features:[B],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,r){e&1&&N(0,nt,0,0,"ng-template",0)},dependencies:[R],styles:["[_nghost-%COMP%]{display:block;background-color:transparent;width:100%;height:100%}[_nghost-%COMP%]:focus{outline:none}@media screen and (forced-colors: active){[_nghost-%COMP%]{border:1px solid CanvasText;background:Canvas}}"]})}}return i})(),ut=0,y=class{constructor(a,t,e,r,o=`nx-overlay-${ut++}`){this._overlayRef=a,this._containerInstance=t,this.origin=e,this._router=r,this.id=o,this.closeOnClickOutside=this._containerInstance._config.closeOnClickOutside,this._afterOpened=new h,this._afterClosed=new h,this._beforeClosed=new h,this._state=0,this._documentClickObservable=F(document,"click"),a.backdropClick().pipe(u(this._afterClosed)).subscribe(()=>{this.closeOnClickOutside&&this.close()}),setTimeout(()=>this.waitForClose()),this._router.events.pipe(u(this.afterClosed())).subscribe(s=>{s instanceof H&&this.close()}),t._id=o,a.detachments().pipe(u(this._afterClosed)).subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),a.keydownEvents().pipe(g(s=>s.keyCode===27&&!q(s)),u(this._afterClosed)).subscribe(s=>{s.preventDefault(),this.close()}),this._afterOpened.next(),this._afterOpened.complete()}waitForClose(){this._documentClickObservable.pipe(E(a=>a.target),g(a=>!this._overlayRef.overlayElement?.contains(a)),u(this._afterClosed)).subscribe(()=>{this.closeOnClickOutside&&this.close()})}close(a){this._result=a,this._beforeClosed.next(a),this._beforeClosed.complete(),this._overlayRef.dispose(),this._state=1,this._containerInstance.restoreFocus(),this._containerInstance._config.triggerButton&&this._containerInstance._config.triggerButton.setTriggerInactive()}afterOpened(){return this._afterOpened.asObservable()}afterClosed(){return this._afterClosed.asObservable()}beforeClosed(){return this._beforeClosed.asObservable()}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}addPanelClass(a){return this._overlayRef.addPanelClass(a),this}removePanelClass(a){return this._overlayRef.removePanelClass(a),this}getState(){return this._state}};function f(i){return Error(`Overlay direction "${i}" is invalid.`)}var P={top(i){return{overlayX:"center",overlayY:"bottom"}},"top-start":function(i){return{overlayX:i?"end":"start",overlayY:"bottom"}},"top-end":function(i){return{overlayX:i?"start":"end",overlayY:"bottom"}},bottom(i){return{overlayX:"center",overlayY:"top"}},"bottom-start":function(i){return{overlayX:i?"end":"start",overlayY:"top"}},"bottom-end":function(i){return{overlayX:i?"start":"end",overlayY:"top"}},left(i){return{overlayX:i?"start":"end",overlayY:"center"}},right(i){return{overlayX:i?"end":"start",overlayY:"center"}}},it={top(i){return{originX:"center",originY:"top"}},"top-start":function(i){return{originX:i?"end":"start",originY:"top"}},"top-end":function(i){return{originX:i?"start":"end",originY:"top"}},bottom(i){return{originX:"center",originY:"bottom"}},"bottom-start":function(i){return{originX:i?"end":"start",originY:"bottom"}},"bottom-end":function(i){return{originX:i?"start":"end",originY:"bottom"}},left(i){return{originX:i?"end":"start",originY:"center"}},right(i){return{originX:i?"start":"end",originY:"center"}}},dt=(()=>{class i{constructor(t,e){this._overlay=t,this._dir=e}createPositionStrategy(t,e){let r=this._getFallbackPositions(e.direction,e),o=this.getOrigin(e.direction),s=this.getOverlayPosition(e.direction),n=this.getOffset(e.direction,e);return this._overlay.position().flexibleConnectedTo(t).withPush(!1).withFlexibleDimensions(!0).withLockedPosition().withGrowAfterOpen().withPositions([c(c(c({},o),s),n),...r])}getOrigin(t){if(!t||!(t in it))throw f(t);return it[t](this.isRtl)}getOverlayPosition(t){if(!t||!(t in P))throw f(t);return P[t](this.isRtl)}getOffset(t,e){if(!t||!(t in P))throw f(t);let r=e.offset||ht,[o]=t.split("-");switch(o){case"top":return{offsetY:r*-1};case"bottom":return{offsetY:r};case"left":return{offsetX:r*-1};case"right":return{offsetX:r};default:throw f(t)}}_getFallbackPositions(t,e){if(!t)return[];let r=this._getFallbackOrder(t,e),o=this._resolveFallbacks(r,e).filter(n=>n!==t),s=[];return o.forEach(n=>{let p=this.getOrigin(n),O=this.getOverlayPosition(n),ot=this.getOffset(n,e);s.push(c(c(c({},p),O),ot))}),s}_getFallbackOrder(t,e){let r;switch(e.fallbackOrientation){case"vertical":r=at;break;case"horizontal":r=lt;break;case"clockwise":r=ct;break;default:throw f(e.fallbackOrientation||"")}let[o]=this._splitDirection(t),s=r.indexOf(o);return[...r.slice(s),...r.slice(0,s)]}_splitDirection(t){return t.split("-")}get isRtl(){return this._dir?.value==="rtl"}_getInversePosition(t){return{top:"bottom",bottom:"top",start:"end",end:"start",center:"center"}[t]}_resolveFallbacks(t,e){if(!e.direction)throw f("");let[r,o]=this._splitDirection(e.direction);return t.reduce((s,n)=>(n==="top"||n==="bottom"?o?s.push(`${n}-${o}`,`${n}-${this._getInversePosition(o)}`,n):s.push(n,`${n}-start`,`${n}-end`):s.push(n),s),[])}static{this.\u0275fac=function(e){return new(e||i)(l(d),l(C,8))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),rt=new D("nx-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let i=S(d);return()=>i.scrollStrategies.reposition()}});function ft(i){return()=>i.scrollStrategies.reposition()}var pt={provide:rt,useFactory:ft,deps:[d]},_t=(()=>{class i{constructor(t,e,r,o,s,n,p){this._overlay=t,this._injector=e,this._router=r,this._positionBuilder=o,this._parentOverlayService=s,this._dir=n,this._defaultScrollStrategyFactory=p,this._afterAllClosedAtThisLevel=new h,this._afterOpenedAtThisLevel=new h,this._openOverlaysAtThisLevel=[],this._scrollStrategyFactory=this._defaultScrollStrategyFactory}get openOverlays(){return this._parentOverlayService?this._parentOverlayService.openOverlays:this._openOverlaysAtThisLevel}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}open(t,e,r){if(r=vt(r,new m),r.id&&this.getOverlayById(r.id))throw Error(`Overlay with id "${r.id}" exists already. The overlay id must be unique.`);let o=this._createOverlay(r,e),s=this._attachOverlayContainer(o,r),n=this._attachOverlayContent(t,s,o,r,e);return this.openOverlays.push(n),n.afterClosed().subscribe(()=>this._removeOpenOverlay(n)),r.triggerButton&&r.triggerButton.setTriggerActive(),n}getOverlayById(t){return this.openOverlays.find(e=>e.id===t)}ngOnDestroy(){this._closeOverlays(this._openOverlaysAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t,e){let r=this._getOverlayConfig(t,e);return this._overlay.create(r)}_getOverlayConfig(t,e){let r=new tt({positionStrategy:t.positionStrategy||this._positionBuilder.createPositionStrategy(e,t),scrollStrategy:t.scrollStrategy||this._scrollStrategyFactory(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,width:t.width,height:t.height,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation,direction:this.dir});return t.backdropClass&&(r.backdropClass=t.backdropClass),r}get isRtl(){return this._dir?.value==="rtl"}_attachOverlayContainer(t,e){let r=e?.viewContainerRef?.injector,o=_.create({parent:r||this._injector,providers:[{provide:m,useValue:e}]}),s=new w(et,e.viewContainerRef,o,e.componentFactoryResolver);return t.attach(s).instance}_attachOverlayContent(t,e,r,o,s){let n=new y(r,e,s,this._router,o.id);if(t instanceof A)e.attachTemplatePortal(new z(t,null,{$implicit:n}));else{let p=this._createInjector(o,n,e),O=e.attachComponentPortal(new w(t,o.viewContainerRef,p));n.componentInstance=O.instance}return n}_createInjector(t,e,r){let o=t?.viewContainerRef?.injector,s=[{provide:et,useValue:r},{provide:y,useValue:e}];return _.create({parent:o||this._injector,providers:s})}_removeOpenOverlay(t){let e=this.openOverlays.indexOf(t);e>-1&&this.openOverlays.splice(e,1)}_closeOverlays(t){let e=t.length;for(;e--;)t[e].close()}static{this.\u0275fac=function(e){return new(e||i)(l(d),l(_),l(G),l(dt),l(i,12),l(C,8),l(rt))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function vt(i,a){return c(c({},a),i)}var Mt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=L({type:i})}static{this.\u0275inj=T({providers:[_t,pt],imports:[k,U,J,Q,k]})}}return i})(),Xt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=Y({type:i})}}return i})();export{_t as a,Mt as b,Xt as c};
